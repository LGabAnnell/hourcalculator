<app-week-picker (onDateChange)="createTable($event)"></app-week-picker>
<mat-table *ngIf="(subj | async)?.includes('h')" [dataSource]="toDisplay" class="mat-elevation-z1" flex
           matSort>
  <ng-container matColumnDef="date">
    <mat-header-cell *matHeaderCellDef mat-sort-header>Date</mat-header-cell>
    <mat-cell *matCellDef="let element">
      <button (click)="dateClick(element.date)" color="primary" mat-flat-button>
        {{ element.date }}
      </button>
    </mat-cell>
  </ng-container>

  <ng-container *ngFor="let a of dynamicColumnArray;" [matColumnDef]="a">
    <mat-header-cell *matHeaderCellDef
                     mat-sort-header>{{ a.includes('entree') ? 'Entrée' : 'Sortie' }}</mat-header-cell>
    <mat-cell *matCellDef="let element">{{ element[a] }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="total">
    <mat-header-cell *matHeaderCellDef mat-sort-header>Total travaillé</mat-header-cell>
    <mat-cell *matCellDef="let element">
      <span class="mat-flat-button bg-grey">{{ element.total | durationToString }}</span>
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="diff">
    <mat-header-cell *matHeaderCellDef>Différence</mat-header-cell>
    <mat-cell *matCellDef="let element">
            <span [ngClass]="element.diff?.hours() < 0 || element.diff?.minutes() < 0 ? 'time-nok' : 'time-ok'"
                  class="mat-flat-button no-hover">{{ (element.diff > 0 ? '&nbsp;' + (element.diff | durationToString) :
              element.diff | durationToString) + '&nbsp;' }}
            </span>
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
</mat-table>
<mat-card *ngIf="(subj | async)?.includes('a')">
  <mat-card-content>
    Malheureusement rien à afficher :(
  </mat-card-content>
</mat-card>
<div *ngIf="!(subj | async)"
     style="display: flex; flex-direction: column; justify-content: center; align-items: center; flex: 1 1;">
  <mat-spinner></mat-spinner>
</div>
